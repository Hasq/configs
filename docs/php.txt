

$stack = [];

// use while because array is changed dinamicaly.
// and foreach work with elements existed on loop start
// CAREFUL! original array will be modified
while ([] !== $stack) {
    // NB! most of all `array_*`, `each` functions reset inner index
    // NB! $stack[] = 'foo' leave index as is

    // Lower three lines  array_shift but without keys reindex
    // ALWAYS get first element even array was modified
    $v = current($stack);
    $k = key($stack);
    unset($stack[$k]);

    // $stack[] = 'foo';
    // do something with array $stack
    // every element will be processed
    // even you create element with lower index than current
}


